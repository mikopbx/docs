# Синхронизация с LDAP/AD

Модуль предназначен для двухстронней синхронизации учетных данных сотрудников компании с MikoPBX. В качестве источника данных используется сервер ActiveDirecory или LADP.&#x20;

<figure><img src="../../.gitbook/assets/ModuleLdapSync - indexRU.png" alt=""><figcaption><p>Настройка серверов Active Direcory для синхронизации пользователей с MikoPBX</p></figcaption></figure>

Для каждого AD/LDAP сервера можно укзать параметры синхронизации, фильтр по отделу или произвольный фильтр, если нужна сложная логика фильтрации.

<figure><img src="../../.gitbook/assets/ModuleLdapSync - modify ru1.png" alt=""><figcaption></figcaption></figure>

Далее нужно правильно указать синхронизируемые атрибуты учетных записей.

<figure><img src="../../.gitbook/assets/ModuleLdapSync - modify ru2.png" alt=""><figcaption><p>Настройка атрибутов синхронизации MikoPBX и домена</p></figcaption></figure>

При первоначальной синхронизации будет выполнено сопоставление уже введенных в MikoPBX учетных записей сотрудников с данными полученными из домена.

В качестве полей для поиска соответствий испольуются:

* Адрес электронной почты
* Имя сотрудника
* Мобильный телефон
* Внутренний телефон

После этого данные в MikoPBX будут обновлены, в соответвсии с данными указанными в домене.

Перед включением автоматической синхронизации, рекомендуется проверить правильность указания атрибутов, для этого можно выполнить тестовое получение данных из домена нажатием на кнопку **Выполнить запрос**

<figure><img src="../../.gitbook/assets/ModuleLdapSync - modify 4 ru.png" alt=""><figcaption><p>Тестирование синхронизации данных с AD/LDAP</p></figcaption></figure>

Если все параметры указаны верно, но вы увидите список сотрудников с указанными атрибутами из домена.

Это безопасный запрос, он не изменяет никаких данных в системе. Если вы видите, что список сотрудников соответвует заданным критериям, можно выполнить ручную синхронизацию данных.&#x20;

При первом нажатии на кноку ручной синхронизации произойдет загрузка данных в MikoPBX, сопоставление списка сотрудников с существующими на текущий момент данными и при необходимости будут созданы новые учетные записи сотрудников с автоматическим присвоением внутреннего номера.&#x20;

Если разрешено обновлять данные в домене и у пользователя указанного в настройках сервера LDAP/AD есть права на изменение атрибутов у указанного в фильтре подразделения, то при повторном нажатии на кнопку синхронизации, данные о номерах сотрудников, фотографии будут выгружены в соответвующие атрибуты домена.

<figure><img src="../../.gitbook/assets/ModuleLdapSync - modify 5ru.png" alt=""><figcaption><p>Статус синхронизации сотрудников домена и MikoPBX</p></figcaption></figure>

В колонках "_статус"_ и "_обновлен"_, можно отследить текущее состояние синхронизации.

При каждом последующем нажатии на кнопку синхронизации, при отстутвии изменений в домене, статус всех сотрудников будет "_пропущен_".

При необходимости, можно активировать автоматическую синхронизацию данных по расписанию.

{% hint style="info" %}
На текущий момент не реализовано никаких действий на удаление сотрудника из домена. Учетная запись такого сотрудника остается в MikoPBX до его ручного удаления администратором MikoPBX.  Это связано с тем, что возможны различные сложные сценарии маршрутизации вызовов, при которых невозможно просто удалить сотрудника из маршрута звонков, не заменив его другим.
{% endhint %}
