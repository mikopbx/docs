# Обновление Docker

Для обновления контейнера MikoPBX до последней версии, вы можете выполнить следующие шаги в командной строке. Эти шаги включают остановку текущего контейнера, скачивание новой версии образа и запуск контейнера с использованием обновлённого образа. Вот пример такого процесса:

### Обновление Docker контейнера

#### Шаг 1: Остановка текущего контейнера

Для начала нужно корректно остановить работающий контейнер. Это позволяет избежать потери данных и гарантирует, что все процессы внутри контейнера завершатся правильно:

```bash
docker stop mikopbx
```

#### Шаг 2: Удаление текущего контейнера

После остановки контейнера его можно безопасно удалить. Удаление контейнера нужно для того, чтобы можно было запустить новый экземпляр с новыми настройками и образом:

```bash
docker rm mikopbx
```

#### Шаг 3: Скачивание последней версии образа

Следующий шаг — это скачивание последней версии образа MikoPBX. Использование тега `latest` обеспечивает получение самой свежей версии:

```bash
docker pull ghcr.io/mikopbx/mikopbx-x86-64:latest
```

#### Шаг 4: Запуск нового контейнера с обновлённым образом

Наконец, запускаем новый контейнер с использованием последней версии образа и теми же настройками, что и ранее (включая монтирование томов и прочие параметры сети):

```bash
docker run --cap-add=NET_ADMIN --net=host --name mikopbx --hostname mikopbx \
  -v mikopbx_cf:/cf \
  -v mikopbx_storage:/storage \ 
  -e SSH_PORT=23 \ 
  -e ID_WWW_USER="$(id -u www-user)" \ 
  -e ID_WWW_GROUP="$(id -g www-user)" \ 
  -it -d --restart always ghcr.io/mikopbx/mikopbx-x86-64:latest
```

### Примечания

* **Данные**: Поскольку данные сохраняются в Docker Volume (`mikopbx_cf` и `mikopbx_storage`), они остаются нетронутыми при обновлении, что позволяет сохранить настройки и пользовательские данные.
* **Переменные окружения**: Убедитесь, что все необходимые переменные окружения передаются корректно.
* **Безопасность**: Перед обновлением всегда рекомендуется создать резервные копии ваших данных.

Эти шаги помогут обеспечить гладкое и безопасное обновление вашего контейнера MikoPBX.
